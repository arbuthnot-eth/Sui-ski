name = "sui-ski-gateway"
main = "src/index.ts"
compatibility_date = "2025-01-15"
compatibility_flags = ["nodejs_compat"]
account_id = "6a10ee79fe9d21b5e2c3155ce8690742"

# Wildcard route for *.sui.ski
routes = [
  { pattern = "*.sui.ski/*", zone_name = "sui.ski" },
  { pattern = "sui.ski/*", zone_name = "sui.ski" },
  { pattern = "*.t.sui.ski/*", zone_name = "sui.ski" },
  { pattern = "t.sui.ski/*", zone_name = "sui.ski" },
  { pattern = "*.d.sui.ski/*", zone_name = "sui.ski" },
  { pattern = "d.sui.ski/*", zone_name = "sui.ski" }
]

# Environment variables (non-sensitive)
[vars]
SUI_NETWORK = "mainnet"
# SUI_RPC_URL set via `wrangler secret put SUI_RPC_URL` (Triton token URL)
WALRUS_NETWORK = "mainnet"
# Seal configuration for encrypted messaging (using TESTNET for open mode key servers)
# Main app uses mainnet, but Seal uses testnet because mainnet key servers require registration
SEAL_NETWORK = "testnet"
SEAL_PACKAGE_ID = "0x8afa5d31dbaa0a8fb07082692940ca3d56b5e856c5126cb5a3693f0a4de63b82"
# Testnet open mode key servers (no registration required)
# Mysten Labs #1, Mysten Labs #2, Triton One - using 3 for threshold encryption
SEAL_KEY_SERVERS = "0x73d05d62c18d9374e3ea529e8e0ed6161da1a141a94d3f76ae3fe4e99356db75,0xf5d14a81a982144ae441cd7d64b09027f116a468bd36e7eca494f750591623c8,0x4cded1abeb52a22b6becb42a91d3686a4c901cf52eee16234214d0b5b2da4c46"
# IKA dWallet package ID for cross-chain control (set when deploying IKA integration)
# IKA_PACKAGE_ID = ""
# Agency registry object ID (set after deploying agency registry contract)
# AGENCY_REGISTRY_ID = ""
# LLM API URL (defaults to Anthropic if not set)
# LLM_API_URL = "https://api.anthropic.com/v1/messages"

# SuiNS name to receive leftover NS tokens from registrations (for LP accumulation)
SERVICE_FEE_NAME = "brando.sui"
DISCOUNT_RECIPIENT_NAME = "extra.sui"

# Secrets (set via `wrangler secret put <NAME>`)
# LLM_API_KEY - API key for LLM provider (Anthropic/OpenAI)

# SuiNS mainnet addresses (source: suins docs / @mysten/suins constants)
SUBNAMECAP_SUINS_PACKAGE_ID = "0xd22b24490e0bae52676651b4f56660a5ff8022a2576e0089f79b3c88d44e08f0"
SUBNAMECAP_SUBDOMAINS_PACKAGE_ID = "0xe177697e191327901637f8d2c5ffbbde8b1aaac27ec1024c4b62d1ebd1cd7430"
SUBNAMECAP_SUINS_OBJECT_ID = "0x6e0ddefc0ad98889c04bab9639e512c21766c5e6366f89e696956d9be6952871"
JACKET_SINGLE_USE_PACKAGE_ID = "0x61248137952b4ae1657fcc5e88464eba79315633eae9b01ff4d7331fa3706d50"
JACKET_FEE_PACKAGE_ID = "0xc91aafec24a289ffff75a1e325137b8aec8a4708d19383df821c3418b59758ef"
JACKET_ALLOWLIST_PACKAGE_ID = "0x41fa2f2453c5416091ee5d7d704cd8bf2755f092ba8d9486a405890d4b37b288"
JACKET_RATE_LIMIT_PACKAGE_ID = "0x82126c5ed40f5daf4f3f74a6c9ccefa73193efcc622e1019147d355bc46b532c"
JACKET_FEE_OBJECT_ID = "0x3961518f5fd71ff6ac3d221ed20e13f8ce7159912a4b00b0d6bbbe33fb706f37"
# JACKET_ALLOWLIST_OBJECT_ID = ""
# JACKET_RATE_LIMIT_OBJECT_ID = ""
DECAY_AUCTION_PACKAGE_ID = "0x7f4c0c75556cfbc2dd934d4248d725392c3fa057a0d784220ce03fec77684f62"
BLACK_DIAMOND_PACKAGE_ID = "0xdf88c0a49d63999034c488dad1e22e6250f8b6a9f709bdfe2b8e4ed6dfde0754"
# BRAVE_SEARCH_API_KEY set via `wrangler secret put BRAVE_SEARCH_API_KEY`
# INDEXER_API_KEY set via `wrangler secret put INDEXER_API_KEY`

# KV namespace for caching resolved names
[[kv_namespaces]]
binding = "CACHE"
id = "c0054cf22c6a4daa99cb36347fa5229c"

# Durable Objects
[[durable_objects.bindings]]
name = "WALLET_SESSIONS"
class_name = "WalletSession"
script_name = "sui-ski-gateway"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["WalletSession"]
